(this["webpackJsonpdankstocks-client"]=this["webpackJsonpdankstocks-client"]||[]).push([[21],{1277:function(e,a,t){"use strict";a.a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.replace(/\s+/," ").split(" ").slice(0,2).map((function(e){return e&&e[0].toUpperCase()})).join("")}},1281:function(e,a,t){"use strict";var n=t(20),r=t(0),c=t.n(r),l=t(676),o=t(1134),i=t(647),s=t(354),u=t(1132),m=t(1175),p=t(366),d=t(1297),f=t.n(d),b=t(1298),E=t.n(b),g=t(1299),v=t.n(g),O=t(1300),j=t.n(O),y=t(1290),h=t.n(y),x=Object(l.a)((function(){return{menu:{width:256,maxWidth:"100%"}}}));a.a=Object(r.memo)((function(e){var a=x(),t=Object(r.useRef)(null),l=Object(r.useState)(!1),d=Object(n.a)(l,2),b=d[0],g=d[1];return c.a.createElement(c.a.Fragment,null,c.a.createElement(o.a,{title:"More options"},c.a.createElement(i.a,Object.assign({onClick:function(){g(!0)},ref:t},e),c.a.createElement(f.a,{fontSize:"small"}))),c.a.createElement(s.a,{anchorEl:t.current,anchorOrigin:{vertical:"top",horizontal:"left"},onClose:function(){g(!1)},open:b,PaperProps:{className:a.menu},transformOrigin:{vertical:"top",horizontal:"left"}},c.a.createElement(u.a,null,c.a.createElement(m.a,null,c.a.createElement(E.a,null)),c.a.createElement(p.a,{primary:"Import"})),c.a.createElement(u.a,null,c.a.createElement(m.a,null,c.a.createElement(v.a,null)),c.a.createElement(p.a,{primary:"Copy"})),c.a.createElement(u.a,null,c.a.createElement(m.a,null,c.a.createElement(j.a,null)),c.a.createElement(p.a,{primary:"Export"})),c.a.createElement(u.a,null,c.a.createElement(m.a,null,c.a.createElement(h.a,null)),c.a.createElement(p.a,{primary:"Archive"}))))}))},1282:function(e,a,t){"use strict";var n=t(84),r=t(40),c=t(0),l=t.n(c),o=t(3),i=t(676),s=t(17),u=Object(i.a)((function(e){return{root:{fontFamily:e.typography.fontFamily,alignItems:"center",borderRadius:2,display:"inline-flex",flexGrow:0,whiteSpace:"nowrap",cursor:"default",flexShrink:0,fontSize:e.typography.pxToRem(12),fontWeight:e.typography.fontWeightMedium,height:20,justifyContent:"center",letterSpacing:.5,minWidth:20,padding:e.spacing(.5,1),textTransform:"uppercase"},primary:{color:e.palette.primary.main,backgroundColor:Object(s.c)(e.palette.primary.main,.08)},secondary:{color:e.palette.secondary.main,backgroundColor:Object(s.c)(e.palette.secondary.main,.08)},error:{color:e.palette.error.main,backgroundColor:Object(s.c)(e.palette.error.main,.08)},success:{color:e.palette.success.main,backgroundColor:Object(s.c)(e.palette.success.main,.08)},warning:{color:e.palette.warning.main,backgroundColor:Object(s.c)(e.palette.warning.main,.08)}}}));a.a=function(e){var a=e.className,t=void 0===a?"":a,c=e.color,i=void 0===c?"secondary":c,s=e.children,m=(e.style,Object(r.a)(e,["className","color","children","style"])),p=u();return l.a.createElement("span",Object.assign({className:Object(o.a)(p.root,Object(n.a)({},p[i],i),t)},m),s)}},1425:function(e,a,t){"use strict";t.r(a);var n=t(6),r=t.n(n),c=t(12),l=t(20),o=t(0),i=t.n(o),s=t(676),u=t(1149),m=t(370),p=t(1204),d=t(1202),f=t(373),b=t(32),E=t(141),g=t(1150),v=t(29),O=t(84),j=t(40),y=t(14),h=t(3),x=t(4),k=t.n(x),C=t(1289),w=t.n(C),S=t(143),N=t.n(S),B=t(1151),P=t(1152),_=t(1145),A=t(1197),T=t(1176),I=t(1199),M=t(1200),W=t(1177),R=t(1198),F=t(1128),Y=t(1192),D=t(1282),z=t(1281),L=t(1183),U=t(1188),q=t(1181),$=t(1142),G=t(1182),V=t(641),J=t(1411),H=t(1386),K=t(1143),Q=t(60),X=Object(s.a)((function(e){return{root:{}}})),Z=function(e){var a=e.className,t=e.postId,n=e.open,s=e.onOpen,u=e.onSuccess,m=Object(j.a)(e,["className","postId","open","onOpen","onSuccess"]),p=X(),d=Object(Q.a)().user,f=Object(o.useState)(),E=Object(l.a)(f,2),v=E[0],O=E[1],y=Object(o.useState)(),x=Object(l.a)(y,2),k=x[0],C=x[1];Object(o.useEffect)((function(){(function(){var e=Object(c.a)(r.a.mark((function e(){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.get("/posts/getById/"+t);case 2:(a=e.sent).data&&C(a.data.post.author);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[t]);var w=function(){var e=Object(c.a)(r.a.mark((function e(){var a,t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={stripeId:k.stripeId,author:k._id,type:"payment_success",amount:v},e.next=3,b.a.post("/stripe/transfer",a);case 3:return t=e.sent,e.next=6,b.a.post("/transactions/create",{user:k._id,client:d._id,amount:v,fee:0,type:"post_approved"});case 6:t.data&&u();case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),S=function(){return s()};return i.a.createElement("div",Object.assign({className:Object(h.a)(p.root,a)},m),k&&i.a.createElement(L.a,{open:n,keepMounted:!0,onClose:S,"aria-labelledby":"checkform-dialog",fullWidth:!0},i.a.createElement(q.a,null,i.a.createElement(g.a,{container:!0,justify:"center"},i.a.createElement(g.a,{item:!0,md:5},i.a.createElement($.a,{label:"Email",defaultValue:k.email,InputProps:{readOnly:!0}})),i.a.createElement(g.a,{item:!0,md:5},i.a.createElement($.a,{label:"Amount",onChange:function(e){return O(e.target.value)},InputProps:{startAdornment:i.a.createElement(K.a,{position:"start"},"$")}})))),i.a.createElement(G.a,null,i.a.createElement(V.a,{onClick:S,color:"primary"},"Cancel"),i.a.createElement(V.a,{onClick:w,color:"primary"},"Confirm"))))},ee=[{name:"pending",text:"pending"},{name:"approved",text:"approve"},{name:"rejected",text:"reject"}],ae=Object(s.a)((function(e){return{root:{},toggleBtn:{"&.MuiToggleButton-root":{color:e.palette.text.primary},"&.Mui-selected":{backgroundColor:e.palette.secondary.main,color:e.palette.common.white}}}})),te=function(e){var a=e.open,t=e.data,n=e.onOpen,s=e.onFetch,u=e.className,m=Object(j.a)(e,["open","data","onOpen","onFetch","className"]),p=ae(),d=Object(o.useState)(t.status),f=Object(l.a)(d,2),E=f[0],g=f[1],v=Object(o.useState)(t.reason),O=Object(l.a)(v,2),y=O[0],x=O[1],k=Object(o.useState)(!1),C=Object(l.a)(k,2),w=C[0],S=C[1],N=function(){var e=Object(c.a)(r.a.mark((function e(){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={_id:t._id,status:E,reason:y},e.next=3,b.a.put("/posts/update/status",a);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),B=function(){var e=Object(c.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n(),"approved"===E?S(!w):(N(),s());case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),P=function(){return n()},_=function(){return S(!w)};return i.a.createElement("div",Object.assign({className:Object(h.a)(p.root,u)},m),a&&i.a.createElement(L.a,{open:a,keepMounted:!0,onClose:P,"aria-labelledby":"status-dialog"},i.a.createElement(U.a,null,"Post Status"),i.a.createElement(q.a,null,i.a.createElement(J.a,{value:E,exclusive:!0,size:"small",onChange:function(e,a){g(a)},"aria-label":"text alignment"},ee.map((function(e,a){return i.a.createElement(H.a,{key:e.name+a,value:e.name,className:p.toggleBtn},e.text)}))),i.a.createElement($.a,{value:y,margin:"dense",type:"text",onChange:function(e){x(e.target.value)},fullWidth:!0})),i.a.createElement(G.a,null,i.a.createElement(V.a,{onClick:P,color:"primary"},"Cancel"),i.a.createElement(V.a,{onClick:B,disabled:E===t.status,color:"primary"},"Confirm"))),w&&i.a.createElement(Z,{open:w,postId:t._id,onOpen:_,onSuccess:function(){N(),_(),s()}}))},ne=t(25),re={approved:"success",pending:"warning",rejected:"error"},ce=[{name:"title",value:"Title"},{name:"author",value:"Author"},{name:"total",value:"Total"},{name:"status",value:"Status"},{name:"createdAt",value:"Date"}],le={page:0,limit:5,count:0,order:"createdAt",orderBy:"desc"},oe=Object(s.a)((function(e){return{root:{}}})),ie=function(e){var a=e.className,t=Object(j.a)(e,["className"]),n=oe(),s=Object(o.useState)(!1),u=Object(l.a)(s,2),p=u[0],d=u[1],f=Object(o.useState)(null),E=Object(l.a)(f,2),g=E[0],x=E[1],C=Object(o.useState)(le),S=Object(l.a)(C,2),L=S[0],U=S[1],q=Object(o.useState)([]),$=Object(l.a)(q,2),G=$[0],V=$[1],J=function(){var e=Object(c.a)(r.a.mark((function e(){var a,t,n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=Object(O.a)({},L.order,"desc"===L.orderBy?-1:1),t={page:L.page,sortBy:a,limit:L.limit},e.next=5,b.a.post("/admin/posts/all/",t);case 5:n=e.sent,V(n.data.posts),U((function(e){return Object(v.a)(Object(v.a)({},e),{},{count:n.data.count})})),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),U(le),V([]);case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}();Object(o.useEffect)((function(){J(),ne.f.on("adminPost",(function(e){J()}))}),[L.page,L.limit,L.order,L.orderBy]);var H=function(e){var a=e.currentTarget.id,t="desc"!==L.orderBy?"desc":"asc";U((function(e){return Object(v.a)(Object(v.a)({},e),{},{order:a,orderBy:t})}))};return i.a.createElement(B.a,Object.assign({className:Object(h.a)(n.root,a)},t),i.a.createElement(P.a,{action:i.a.createElement(z.a,null),title:"All Posts"}),i.a.createElement(_.a,null),i.a.createElement(N.a,null,i.a.createElement(m.a,{minWidth:700},i.a.createElement(A.a,null,i.a.createElement(T.a,null,i.a.createElement(I.a,null,ce.map((function(e){return i.a.createElement(M.a,{key:e.name,align:"center"},i.a.createElement(W.a,{id:e.name,active:L.order===e.name,onClick:H,direction:(a=e.name,L.order===a&&L.orderBy?L.orderBy:"desc"),disabled:"no"===e.name},e.value));var a})))),i.a.createElement(R.a,null,G.map((function(e){return i.a.createElement(I.a,{hover:!0,key:e._id},i.a.createElement(M.a,{align:"center"},"pending"!==e.status?i.a.createElement(F.a,{color:"textPrimary",component:y.a,to:"/posts/public/"+e.slug,variant:"body2"},e.title):i.a.createElement(F.a,{color:"textPrimary",component:y.a,to:"/posts/edit/"+e.slug,variant:"body2"},e.title)),i.a.createElement(M.a,null,i.a.createElement(F.a,{color:"textPrimary",component:y.a,to:"/users/"+e.author.name,variant:"body2"},e.author.name)),i.a.createElement(M.a,{align:"center"},w()(0).format("$0,0.00")),i.a.createElement(M.a,{align:"center",onClick:function(){return x({_id:(a=e)._id,status:a.status,reason:a.reason}),void d(!p);var a}},i.a.createElement(D.a,{color:re[e.status]},e.status)),i.a.createElement(M.a,{align:"center"},k()(e.createdAt).format("DD MMM, YYYY hh:mm:ss")))})))),i.a.createElement(Y.a,{rowsPerPageOptions:[5,10,25],component:"div",count:L.count,rowsPerPage:L.limit,page:L.page,onChangePage:function(e,a){U((function(e){return Object(v.a)(Object(v.a)({},e),{},{page:a})}))},onChangeRowsPerPage:function(e){var a=parseInt(e.target.value,10);U((function(e){return Object(v.a)(Object(v.a)({},e),{},{limit:a,page:0})}))}}))),i.a.createElement(m.a,{p:2,display:"flex",justifyContent:"flex-end"}),g&&i.a.createElement(te,{open:p,data:g,onOpen:function(){return d(!p)},onFetch:J}))},se=t(1157),ue=t(1277),me=t(1422),pe=Object(s.a)((function(e){return{root:{},toggleBtn:{"&.MuiToggleButton-root":{color:e.palette.text.primary},"&.Mui-selected":{backgroundColor:e.palette.secondary.main,color:e.palette.common.white}}}})),de=function(e){var a=e.open,t=e.data,n=e.onOpen,s=e.onFetch,u=e.className,m=Object(j.a)(e,["open","data","onOpen","onFetch","className"]),p=pe(),d=Object(o.useState)(t.status),f=Object(l.a)(d,2),E=f[0],v=f[1],O=Object(o.useState)(t.reason),y=Object(l.a)(O,2),x=y[0],k=y[1],C=Object(o.useState)(t.banned),w=Object(l.a)(C,2),S=w[0],N=w[1],B=function(){var e=Object(c.a)(r.a.mark((function e(){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={_id:t._id,status:E,reason:x,banned:S},e.next=3,b.a.put("/users/update/status",a);case 3:s(),n();case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),P=function(){n()};return i.a.createElement("div",Object.assign({className:Object(h.a)(p.root,u)},m),i.a.createElement(L.a,{open:a,keepMounted:!0,onClose:P,"aria-labelledby":"status-dialog"},i.a.createElement(U.a,null,"User Status"),i.a.createElement(q.a,null,i.a.createElement(g.a,{container:!0,justify:"center"},i.a.createElement(g.a,{item:!0,md:5,xs:12},i.a.createElement(J.a,{value:E,exclusive:!0,size:"small",onChange:function(e,a){v(Boolean(a))},"aria-label":"user alignment"},i.a.createElement(H.a,{value:!0,className:p.toggleBtn},"Active"),i.a.createElement(H.a,{value:!1,className:p.toggleBtn},"Block"))),i.a.createElement(g.a,{item:!0,md:7,xs:12},i.a.createElement(me.a,{fullWidth:!0,inputVariant:"standard",label:"Date",name:"banned",onChange:function(e){N(e)},value:S})),i.a.createElement(g.a,{item:!0,md:12,xs:12},i.a.createElement($.a,{value:x,margin:"dense",type:"text",onChange:function(e){k(e.target.value)},fullWidth:!0})))),i.a.createElement(G.a,null,i.a.createElement(V.a,{onClick:P,color:"primary"},"Cancel"),i.a.createElement(V.a,{onClick:B,color:"primary",disabled:!E&&!S},"Confirm"))))},fe=[{name:"name",value:"Name"},{name:"email",value:"Email"},{name:"role",value:"Role"},{name:"status",value:"Status"},{name:"createdAt",value:"Date"}],be={page:0,limit:5,count:0,order:"createdAt",orderBy:"desc"},Ee=Object(s.a)((function(e){return{root:{}}})),ge=function(e){var a=e.className,t=Object(j.a)(e,["className"]),n=Ee(),s=Object(o.useState)(!1),u=Object(l.a)(s,2),p=u[0],d=u[1],f=Object(o.useState)(),E=Object(l.a)(f,2),g=E[0],x=E[1],C=Object(o.useState)(be),w=Object(l.a)(C,2),S=w[0],L=w[1],U=Object(o.useState)([]),q=Object(l.a)(U,2),$=q[0],G=q[1],V=function(){var e=Object(c.a)(r.a.mark((function e(){var a,t,n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=Object(O.a)({},S.order,"desc"===S.orderBy?-1:1),t={page:S.page,sortBy:a,limit:S.limit},e.next=5,b.a.post("/admin/users/all/",t);case 5:n=e.sent,G(n.data.users),L((function(e){return Object(v.a)(Object(v.a)({},e),{},{count:n.data.count})})),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),L(be),G([]);case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}();Object(o.useEffect)((function(){V()}),[S.page,S.limit,S.order,S.orderBy]);var J=function(e){var a=e.currentTarget.id,t="desc"!==S.orderBy?"desc":"asc";L((function(e){return Object(v.a)(Object(v.a)({},e),{},{order:a,orderBy:t})}))};return i.a.createElement(B.a,Object.assign({className:Object(h.a)(n.root,a)},t),i.a.createElement(P.a,{action:i.a.createElement(z.a,null),title:"All Users"}),i.a.createElement(_.a,null),i.a.createElement(N.a,null,i.a.createElement(m.a,{minWidth:700},i.a.createElement(A.a,null,i.a.createElement(T.a,null,i.a.createElement(I.a,null,fe.map((function(e){return i.a.createElement(M.a,{key:e.name,align:"center"},i.a.createElement(W.a,{id:e.name,active:S.order===e.name,onClick:J,direction:(a=e.name,S.order===a&&S.orderBy?S.orderBy:"desc"),disabled:"no"===e.name},e.value));var a})))),i.a.createElement(R.a,null,$.map((function(e){return i.a.createElement(I.a,{hover:!0,key:e._id},i.a.createElement(M.a,null,i.a.createElement(m.a,{display:"flex",alignItems:"center"},i.a.createElement(se.a,{alt:"Author",src:e.avatar,component:y.a,to:"/users/"+e.name},Object(ue.a)(e.name)),i.a.createElement(m.a,{ml:1},i.a.createElement(F.a,{color:"textPrimary",component:y.a,to:"/users/"+e.name,variant:"body2"},e.name)))),i.a.createElement(M.a,{align:"center"},e.email),i.a.createElement(M.a,{align:"center"},e.role),i.a.createElement(M.a,{align:"center",onClick:function(){return x({_id:(a=e)._id,status:a.status,reason:a.reason,banned:a.banned}),void d(!p);var a}},i.a.createElement(D.a,{color:e.status?"success":"error"},e.status?"Active":"Banned")),i.a.createElement(M.a,{align:"center"},k()(e.createdAt).format("DD MMM, YYYY hh:mm:ss")))})))),i.a.createElement(Y.a,{rowsPerPageOptions:[5,10,25],component:"div",count:S.count,rowsPerPage:S.limit,page:S.page,onChangePage:function(e,a){L((function(e){return Object(v.a)(Object(v.a)({},e),{},{page:a})}))},onChangeRowsPerPage:function(e){var a=parseInt(e.target.value,10);L((function(e){return Object(v.a)(Object(v.a)({},e),{},{limit:a,page:0})}))}}))),i.a.createElement(m.a,{p:2,display:"flex",justifyContent:"flex-end"}),p&&i.a.createElement(de,{open:p,data:g,onOpen:function(){d(!p)},onFetch:V}))},ve=t(644),Oe=t(39),je=t(365),ye=t(366),he=t(1134),xe=Object(s.a)((function(e){return{root:{},viewButton:{marginLeft:e.spacing(2)}}})),ke=function(e){var a,t=e.className,n=e.flag,r=Object(j.a)(e,["className","flag"]),c=xe(),l=Object(Oe.g)();return i.a.createElement(je.a,Object.assign({className:Object(h.a)(c.root,t)},r),i.a.createElement(ye.a,{primary:i.a.createElement(F.a,{color:"textPrimary",onClick:function(){return l.push("/posts/public/"+n.post.slug,{from:"admin",comment:n.comment})},underline:"none",variant:"h6"},null===(a=ne.c.find((function(e){return e.name===n.reason})))||void 0===a?void 0:a.label),primaryTypographyProps:{variant:"h6",noWrap:!0},secondary:i.a.createElement(i.a.Fragment,null,n.description&&""!==n.description&&i.a.createElement(i.a.Fragment,null,n.description,i.a.createElement("br",null)),k()(n.createdAt).fromNow())}),i.a.createElement(he.a,{key:n.user._id,title:"View Profile"},i.a.createElement(se.a,{src:n.user.avatar,alt:"Person",component:y.a,to:"/users/"+n.user.name})))},Ce=Object(s.a)((function(){return{root:{}}})),we=function(e){var a=e.className,t=Object(j.a)(e,["className"]),n=Ce(),s=Object(E.a)(),u=Object(o.useState)([]),p=Object(l.a)(u,2),d=p[0],f=p[1],g=Object(o.useCallback)(Object(c.a)(r.a.mark((function e(){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.a.get("/comments/flagsAll");case 3:a=e.sent,s.current&&f(a.data.flags),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),[s]);return Object(o.useEffect)((function(){g(),ne.f.on("adminComment",(function(e){g()}))}),[g]),i.a.createElement(B.a,Object.assign({className:Object(h.a)(n.root,a)},t),i.a.createElement(P.a,{action:i.a.createElement(z.a,null),title:"Reports"}),i.a.createElement(_.a,null),i.a.createElement(N.a,null,i.a.createElement(m.a,{minWidth:400},i.a.createElement(ve.a,null,d.map((function(e,a){return i.a.createElement(ke,{divider:a<d.length-1,key:e._id,flag:e})}))))))},Se=function(){return i.a.createElement(g.a,{container:!0,spacing:3},i.a.createElement(g.a,{item:!0,lg:12,xl:12,xs:12},i.a.createElement(ie,null)),i.a.createElement(g.a,{item:!0,lg:4,xl:4,xs:12},i.a.createElement(we,null)),i.a.createElement(g.a,{item:!0,lg:8,xl:8,xs:12},i.a.createElement(ge,null)))},Ne=[{name:"no",value:"No"},{name:"createdAt",value:"Date"},{name:"status",value:"Status"},{name:"type",value:"Type"},{name:"client",value:"Client"},{name:"amount",value:"Initial Pyament"},{name:"fee",value:"Fee"},{name:"income",value:"Net Income"},{name:"refund",value:""}],Be={page:0,limit:5,order:"createdAt",orderBy:"desc"},Pe=Object(s.a)((function(e){return{root:{},action:{margin:e.spacing(1)}}})),_e=function(e){var a=e.className,t=e.profile,n=Object(j.a)(e,["className","profile"]),s=Pe(),u=Object(Q.a)().user,p=Object(o.useState)(0),d=Object(l.a)(p,2),f=d[0],E=d[1],g=Object(o.useState)(Be),x=Object(l.a)(g,2),C=x[0],w=x[1],S=Object(o.useState)([]),D=Object(l.a)(S,2),z=D[0],L=D[1],U=function(){var e=Object(c.a)(r.a.mark((function e(){var a,t,n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=Object(O.a)({},C.order,"desc"===C.orderBy?-1:1),t={page:C.page,sortBy:a,limit:C.limit,user:u},e.next=5,b.a.post("/admin/refunds",t);case 5:n=e.sent,L(n.data.transactions),E(n.data.count),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.error(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}();Object(o.useEffect)((function(){U(),ne.f.on("requestRefund",(function(e){U()}))}),[C,u]);var q=function(e){var a=e.currentTarget.id,t="desc"!==C.orderBy?"desc":"asc";w((function(e){return Object(v.a)(Object(v.a)({},e),{},{order:a,orderBy:t})}))},$=function(){var e=Object(c.a)(r.a.mark((function e(a){var t,n,c,l;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a._id,n=a.paymentId,c=a.user,l={_id:t,payment_intent:n,user:c},e.next=4,b.a.post("/stripe/refund/",l);case 4:U();case 5:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}();return i.a.createElement(B.a,Object.assign({className:Object(h.a)(s.root,a)},n),i.a.createElement(P.a,{classes:{action:s.action},title:"Latest Refund Transactions"}),i.a.createElement(_.a,null),i.a.createElement(N.a,null,i.a.createElement(m.a,{minWidth:700},i.a.createElement(A.a,null,i.a.createElement(T.a,null,i.a.createElement(I.a,null,Ne.map((function(e){return i.a.createElement(M.a,{key:e.name,align:"center"},i.a.createElement(W.a,{id:e.name,active:C.order===e.name,onClick:q,direction:(a=e.name,C.order===a&&C.orderBy?C.orderBy:"desc"),disabled:"no"===e.name||"income"===e.name||"refund"===e.name||"status"===e.name||"client"===e.name},e.value));var a})))),i.a.createElement(R.a,null,z.map((function(e,a){var n;return i.a.createElement(I.a,{hover:!0,key:e._id},i.a.createElement(M.a,{align:"center"},a+1),i.a.createElement(M.a,{align:"center"},k()(e.createdAt).format("DD MMM, YYYY hh:mm:ss")),i.a.createElement(M.a,{align:"center"},e.user===t._id?"Received":"Sent"),i.a.createElement(M.a,{align:"center"},e.type.split("_").map((function(e){return e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()})).join(" ")),i.a.createElement(M.a,{align:"center"},e.client._id!==t._id&&i.a.createElement(F.a,{color:"inherit",component:y.a,to:"/users/"+e.client.name,variant:"body2"},null===(n=e.client)||void 0===n?void 0:n.name)),i.a.createElement(M.a,{align:"center"},"$",e.amount),i.a.createElement(M.a,{align:"center"},"$",e.fee),i.a.createElement(M.a,{align:"center"},"$",e.amount-e.fee),i.a.createElement(M.a,{width:"10%"},i.a.createElement(V.a,{name:null===e||void 0===e?void 0:e._id,color:"primary",variant:"contained",size:"small",disabled:e.refund,onClick:function(){return $(e)}},"Refund")))})))),i.a.createElement(Y.a,{rowsPerPageOptions:[5,10,25],component:"div",count:f,rowsPerPage:C.limit,page:C.page,onChangePage:function(e,a){return w((function(e){return Object(v.a)(Object(v.a)({},e),{},{page:a})}))},onChangeRowsPerPage:function(e){w((function(a){return Object(v.a)(Object(v.a)({},a),{},{limit:parseInt(e.target.value,10),page:0})}))}}))),i.a.createElement(m.a,{p:2,display:"flex",justifyContent:"flex-end"}))},Ae=t(1278),Te=t(1279),Ie=t(144),Me=t(652),We=t(653),Re=t(675),Fe=t(1132),Ye=t(1138),De=t(169),ze=t(367),Le=t(647),Ue=t(655),qe=t(1325),$e=t.n(qe),Ge=["success","info","warning","error"],Ve=Object(s.a)((function(e){return{root:{padding:e.spacing(3),display:"flex",alignItems:"center",justifyContent:"space-between"},label:{marginLeft:e.spacing(1)},control:{minWidth:300,marginLeft:e.spacing(2),marginBottom:e.spacing(2)},inputContainer:Object(O.a)({flexGrow:1,marginLeft:e.spacing(2),paddingBottom:e.spacing(.5),paddingLeft:e.spacing(.5),paddingRight:e.spacing(.5),paddingTop:e.spacing(.5)},e.breakpoints.down("sm"),{width:"100%"}),box:Object(O.a)({alignItems:"center",display:"flex"},e.breakpoints.down("sm"),{flexWrap:"wrap"})}})),Je=function(e){var a=e.className,t=e.profile,n=Object(j.a)(e,["className","profile"]),l=Ve(),o=Object(Ie.b)().enqueueSnackbar;return i.a.createElement(Te.a,{enableReinitialize:!0,initialValues:{alert:t.alert||"",alertType:t.alertType||"",alertChecked:t.alertChecked||!1,submit:null},validationSchema:Ae.c().shape({alert:Ae.e().required("Content is required")}),onSubmit:function(){var e=Object(c.a)(r.a.mark((function e(a,t){var n,c,l;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.setErrors,c=t.setStatus,l=t.setSubmitting,e.prev=1,e.next=4,b.a.post("/admin/alert",Object(v.a)({},a));case 4:c({success:!0}),l(!1),o("Announcement Updated",{variant:"success"}),e.next=14;break;case 9:e.prev=9,e.t0=e.catch(1),c({success:!1}),n({submit:e.t0.message}),l(!1);case 14:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(a,t){return e.apply(this,arguments)}}()},(function(e){var t=e.errors,r=e.handleChange,c=e.handleSubmit,o=e.isSubmitting,s=e.values;return i.a.createElement("form",{onSubmit:c},i.a.createElement(B.a,Object.assign({className:Object(h.a)(l.root,a)},n),i.a.createElement(m.a,{flexGrow:1},i.a.createElement(m.a,{display:"flex"},i.a.createElement(Me.a,{className:l.control,variant:"outlined",required:!0},i.a.createElement(We.a,null,"Type"),i.a.createElement(Re.a,{name:"alertType",value:s.alertType,onChange:r,label:"Type"},Ge.map((function(e,a){return i.a.createElement(Fe.a,{key:a,value:e},e)})))),i.a.createElement(m.a,{flexGrow:1}),i.a.createElement(m.a,{mr:2},i.a.createElement(Ye.a,{color:"primary",name:"alertChecked",checked:s.alertChecked,onChange:r}))),i.a.createElement(m.a,{className:l.box},i.a.createElement(De.a,{className:l.inputContainer,variant:"outlined"},i.a.createElement(ze.a,{name:"alert",value:s.alert,disableUnderline:!0,fullWidth:!0,multiline:!0,rows:6,onChange:r})),i.a.createElement(he.a,{title:"Send"},i.a.createElement("span",null,i.a.createElement(Le.a,{color:"primary",disabled:o,type:"submit"},i.a.createElement($e.a,null))))),t.alert&&i.a.createElement(m.a,{mt:3},i.a.createElement(Ue.a,{error:!0},t.alert)),t.submit&&i.a.createElement(m.a,{mt:3},i.a.createElement(Ue.a,{error:!0},t.submit)))))}))},He=[{value:"overview",label:"Overview"},{value:"alert",label:"Announcement"},{value:"payment",label:"Transactions"}],Ke=Object(s.a)((function(e){return{root:{backgroundColor:e.palette.background.dark,minHeight:"100%",paddingTop:e.spacing(3),paddingBottom:e.spacing(3)}}}));a.default=function(){var e=Ke(),a=Object(E.a)(),t=Object(o.useState)("overview"),n=Object(l.a)(t,2),s=n[0],g=n[1],v=Object(o.useState)(null),O=Object(l.a)(v,2),j=O[0],y=O[1],h=Object(o.useCallback)(Object(c.a)(r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.get("/account/about");case 2:t=e.sent,a.current&&y(t.data.user);case 4:case"end":return e.stop()}}),e)}))),[a]);if(Object(o.useEffect)((function(){h()}),[h]),!j)return null;return i.a.createElement(f.a,{className:e.root,title:"Administrator"},i.a.createElement(u.a,{maxWidth:!1},i.a.createElement(m.a,{mt:6},i.a.createElement(p.a,{onChange:function(e,a){return g(a)},scrollButtons:"auto",value:s,textColor:"secondary",variant:"scrollable"},He.map((function(e){return i.a.createElement(d.a,{key:e.value,label:e.label,value:e.value})})))),i.a.createElement(m.a,{py:3,pb:6},"alert"===s&&i.a.createElement(Je,{profile:j}),"overview"===s&&i.a.createElement(Se,null),"payment"===s&&i.a.createElement(_e,{profile:j}))))}}}]);
//# sourceMappingURL=21.5e257082.chunk.js.map